# TypeScript Compilation Fixes Patch
# Apply these changes to fix remaining TypeScript compilation errors

## File: src/payments/payments.controller.ts

### Fix Express type imports (Line 18)
```diff
- import { Request, Response } from 'express';
+ import type { Request, Response } from 'express';
```

### Add PrismaService dependency (after existing imports)
```typescript
// Add this import
import { PrismaService } from '../prisma/prisma.service';

// Update constructor to include PrismaService
constructor(
  private readonly paymentsService: PaymentsService,
  private readonly prisma: PrismaService, // Add this line
) {}
```

## File: src/payments/services/razorpay.service.ts

### Fix Razorpay import (Line 3)
```diff
- import * as Razorpay from 'razorpay';
+ import Razorpay from 'razorpay';
```

### Fix type casting issues (Lines 120-123)
```diff
      return {
        id: response.id,
        shortUrl: response.short_url,
-       amount: response.amount,
-       currency: response.currency,
+       amount: Number(response.amount),
+       currency: response.currency || 'INR',
        status: response.status,
-       expireBy: new Date(response.expire_by * 1000),
+       expireBy: response.expire_by ? new Date(response.expire_by * 1000) : new Date(),
      };
```

## File: src/payments/services/flexible-payment.service.ts

### Fix cached response type (Line 55)
```diff
-     return cached;
+     return cached as PaymentOptionsResponseDto;
```

### Fix steps array type definition (around Line 728)
```typescript
// Add proper type definition at the beginning of the function
const steps: Array<{
  action: string;
  description: string;
  deadline: Date;
}> = [];
```

## File: tsconfig.json

### Add allowSyntheticDefaultImports flag
```diff
{
  "compilerOptions": {
    // ... existing options
+   "allowSyntheticDefaultImports": true,
    // ... rest of options
  }
}
```